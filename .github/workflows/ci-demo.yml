# Demo CI/CD pipeline – multiple stages, realistic job names.
# All jobs only print "Hello World" for demonstration.

name: CI/CD Demo Pipeline

on:
  push:
    # No branches filter = runs on push to every branch
  pull_request:
    # No branches filter = runs on PR to every branch

env:
  PYTHON_VERSION: "3.11"

jobs:
  # ═══════════════════════════════════════════════════════════════
  # STAGE 1: Build & Unit Test (3 jobs in parallel)
  # ═══════════════════════════════════════════════════════════════

  unit-tests-core:
    name: Unit Tests · Core
    runs-on: ubuntu-latest
    steps:
      - name: Checkout
        uses: actions/checkout@v4
      - name: Run unit tests (core)
        run: echo "Hello World"

  unit-tests-api:
    name: Unit Tests · API
    runs-on: ubuntu-latest
    steps:
      - name: Checkout
        uses: actions/checkout@v4
      - name: Run unit tests (API)
        run: echo "Hello World"

  unit-tests-helpers:
    name: Unit Tests · Helpers
    runs-on: ubuntu-latest
    steps:
      - name: Checkout
        uses: actions/checkout@v4
      - name: Run unit tests (helpers)
        run: echo "Hello World"

  # ═══════════════════════════════════════════════════════════════
  # STAGE 2: Smoke & Integration (2 jobs, after Stage 1)
  # ═══════════════════════════════════════════════════════════════

  smoke-tests-critical:
    name: Smoke · Critical Paths
    runs-on: ubuntu-latest
    needs: [unit-tests-core, unit-tests-api, unit-tests-helpers]
    steps:
      - name: Checkout
        uses: actions/checkout@v4
      - name: Run smoke tests
        run: echo "Hello World"

  integration-tests-auth:
    name: Integration · Auth
    runs-on: ubuntu-latest
    needs: [unit-tests-core, unit-tests-api, unit-tests-helpers]
    steps:
      - name: Checkout
        uses: actions/checkout@v4
      - name: Run integration tests (auth)
        run: echo "Hello World"

  # ═══════════════════════════════════════════════════════════════
  # STAGE 3: Regression (4 jobs, after Stage 2)
  # ═══════════════════════════════════════════════════════════════

  regression-e2e-checkout:
    name: Regression · E2E Checkout
    runs-on: ubuntu-latest
    needs: [smoke-tests-critical, integration-tests-auth]
    steps:
      - name: Checkout
        uses: actions/checkout@v4
      - name: Run regression (checkout)
        run: echo "Hello World"

  regression-e2e-cart:
    name: Regression · E2E Cart
    runs-on: ubuntu-latest
    needs: [smoke-tests-critical, integration-tests-auth]
    steps:
      - name: Checkout
        uses: actions/checkout@v4
      - name: Run regression (cart)
        run: echo "Hello World"

  regression-e2e-my-account:
    name: Regression · E2E My Account
    runs-on: ubuntu-latest
    needs: [smoke-tests-critical, integration-tests-auth]
    steps:
      - name: Checkout
        uses: actions/checkout@v4
      - name: Run regression (my account)
        run: echo "Hello World"

  regression-e2e-product-pages:
    name: Regression · E2E Product Pages
    runs-on: ubuntu-latest
    needs: [smoke-tests-critical, integration-tests-auth]
    steps:
      - name: Checkout
        uses: actions/checkout@v4
      - name: Run regression (product pages)
        run: echo "Hello World"

  # ═══════════════════════════════════════════════════════════════
  # STAGE 4: Deploy (2 jobs, after Stage 3)
  # ═══════════════════════════════════════════════════════════════

  deploy-staging:
    name: Deploy · Staging
    runs-on: ubuntu-latest
    needs:
      - regression-e2e-checkout
      - regression-e2e-cart
      - regression-e2e-my-account
      - regression-e2e-product-pages
    steps:
      - name: Checkout
        uses: actions/checkout@v4
      - name: Deploy to staging
        run: echo "Hello World"

  deploy-notify:
    name: Deploy · Notify
    runs-on: ubuntu-latest
    needs:
      - regression-e2e-checkout
      - regression-e2e-cart
      - regression-e2e-my-account
      - regression-e2e-product-pages
    steps:
      - name: Checkout
        uses: actions/checkout@v4
      - name: Notify team
        run: echo "Hello World"
